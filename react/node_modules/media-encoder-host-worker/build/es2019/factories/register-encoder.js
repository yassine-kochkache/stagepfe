export const createRegisterEncoder = (encoderBrokerRegistry, ports, wrap) => async (port) => {
    const encoderBroker = wrap(port);
    const regex = await encoderBroker.characterize();
    const regexAsString = regex.toString();
    if (encoderBrokerRegistry.has(regexAsString) || ports.has(port)) {
        throw new Error('There is already an encoder stored which handles exactly the same mime types.');
    }
    encoderBrokerRegistry.set(regexAsString, [regex, encoderBroker]);
    ports.set(port, regexAsString);
    return regex;
};
//# sourceMappingURL=register-encoder.js.map